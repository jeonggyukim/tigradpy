#!/usr/bin/env python

## This file should be improved...

import numpy as np
from scipy.interpolate import interp1d

# SB99 specific FUV luminosity Psi = L_FUV/M_star as a function of age
Psi=[453.08679514, 464.53452871, 475.47798641, 485.7073231 ,
     496.9356504 , 511.96949628, 548.4466934 , 562.63899134,
     592.79623836, 615.30727212, 653.51217536, 720.24242122,
     763.78785281, 786.69155062, 801.01170583, 761.35985867,
     667.88663137, 593.6170566 , 538.91202362, 497.36625759,
     457.87623408, 419.12111464, 388.81524695, 365.90999537,
     346.11651385, 316.07389538, 292.94186317, 274.96469223,
     258.15397177, 239.26669601, 220.01253422, 199.85879126,
     182.25156179, 169.97567772, 159.78310952, 151.33661229,
     143.66317928, 136.40155234, 129.42792748, 122.70219911,
     117.19632053, 112.83371757, 108.73964512, 104.81626952,
     101.08554852,  97.48501856,  94.0111926 ,  90.65558598,
     87.45711133,  84.36600081,  81.42197733,  78.57572024,
     75.82079324,  73.15775994,  70.59190409,  68.11345756,
     65.74853714,  63.83016055,  62.05007971,  60.33343415,
     58.67123283,  57.08305372,  55.58135509,  54.1725337 ,
     52.83354666,  51.55583727,  50.32801935,  49.13451734,
     47.97308984,  46.84956744,  45.76005756,  44.69961541,
     43.67094132,  42.67124003,  41.69927098,  40.75995245,
     39.85595526,  38.96624566,  38.14938374,  37.52161742,
     36.90927209,  36.30833196,  35.72438727,  35.15214723,
     34.59375653,  34.05152912,  33.52439301,  33.01132771,
     32.51351216,  32.03548703,  31.56658689,  31.10721136,
     30.65638137,  30.21401644,  29.7786161 ,  29.35306829,
     28.93444047,  28.52413306,  28.12153029,  27.72770005,
     27.34063726,  26.96049212,  26.59058388,  26.2286874 ,
     25.87839393,  25.53930949,  25.20577962,  24.87753233,
     24.55532672,  24.2366395 ,  23.92356405,  23.61665259,
     23.31338004,  23.01438386,  22.72099394,  22.4325984 ,
     22.14957227,  21.87161268,  21.60064799,  21.3345638 ,
     21.07459035,  20.82300964,  20.58119904,  20.3466166 ,
     20.11706604,  19.89354325,  19.67405505,  19.46068272,
     19.25034161,  19.04528147,  18.84141499,  18.63901451,
     18.43885467,  18.24088716,  18.04310648,  17.84790554,
     17.65578097,  17.46609886,  17.28120726,  17.09724708,
     16.91690797,  16.737069  ,  16.56133404,  16.38751444,
     16.21443932,  16.04098275,  15.867691  ,  15.6937046 ,
     15.51995743,  15.34695103,  15.17566247,  15.01156431,
     14.85040033,  14.69095164,  14.53397608,  14.37892192,
     14.22670176,  14.07635124,  13.92875437,  13.78274391,
     13.63917075,  13.4973675 ,  13.35813056,  13.22123433,
     13.08649759,  12.95453139,  12.8246124 ,  12.69954539,
     12.57635968,  12.45484991,  12.33461741,  12.21537161,
     12.09724828,  11.98061338,  11.86500289,  11.75089772,
     11.63743786,  11.52500048,  11.41363433,  11.30378932,
     11.19527526,  11.08828425,  10.9831809 ,  10.87910342,
     10.77653312,  10.67527811,  10.57519197,  10.47638608,
     10.37855252,  10.28201134,  10.18685478,  10.09308863,
     10.00041292,   9.90877628,   9.81816843,   9.72881811,
      9.64106077,   9.55428174,   9.46869859,   9.38459354,
      9.30185274]

# SB99 specific EUV luminosity Xi = Qi/M_star as a function of age
Xi= [4.12097519e+46,   4.09260660e+46,   4.09260660e+46,
     4.10204103e+46,   4.11149721e+46,   4.12097519e+46,
     4.11149721e+46,   4.11149721e+46,   4.11149721e+46,
     4.10204103e+46,   4.08319386e+46,   3.99944750e+46,
     4.04575892e+46,   4.08319386e+46,   4.11149721e+46,
     4.07380278e+46,   3.93550075e+46,   3.99944750e+46,
     3.98107171e+46,   3.97191549e+46,   3.85478358e+46,
     3.72391706e+46,   3.51560441e+46,   3.35737614e+46,
     3.14774831e+46,   2.83791903e+46,   2.61818301e+46,
     2.33883724e+46,   2.05116218e+46,   1.96336028e+46,
     2.28559880e+46,   2.48313311e+46,   2.54097271e+46,
     2.36591970e+46,   2.18272991e+46,   2.02768272e+46,
     1.88799135e+46,   1.71790839e+46,   1.56314764e+46,
     1.29121927e+46,   1.18304156e+46,   1.08893009e+46,
     9.97700064e+45,   9.37562007e+45,   8.47227414e+45,
     7.87045790e+45,   7.22769804e+45,   5.86138165e+45,
     5.59757601e+45,   5.15228645e+45,   4.68813382e+45,
     4.15910610e+45,   3.53183170e+45,   3.22849412e+45,
     2.84446111e+45,   2.55270130e+45,   2.31739465e+45,
     2.14289060e+45,   1.87931682e+45,   1.70608239e+45,
     1.53461698e+45,   1.38675583e+45,   1.26765187e+45,
     1.15080039e+45,   1.04231743e+45,   9.44060876e+44,
     8.57037845e+44,   7.87045790e+44,   7.24435960e+44,
     6.65273156e+44,   6.13762005e+44,   5.63637656e+44,
     5.19995997e+44,   4.77529274e+44,   4.33510878e+44,
     4.04575892e+44,   3.74973002e+44,   3.49140315e+44,
     3.22849412e+44,   2.99226464e+44,   2.79898132e+44,
     2.61818301e+44,   2.45470892e+44,   2.28559880e+44,
     2.13304491e+44,   1.99067334e+44,   1.88799135e+44,
     1.78648757e+44,   1.68655303e+44,   1.58854675e+44,
     1.49968484e+44,   1.41579378e+44,   1.34276496e+44,
     1.27938130e+44,   1.21059813e+44,   1.14287833e+44,
     1.08893009e+44,   1.02801630e+44,   9.79489985e+43,
     9.31107875e+43,   8.89201118e+43,   8.49180475e+43,
     8.12830516e+43,   7.70903469e+43,   7.44731974e+43,
     7.04693069e+43,   6.71428853e+43,   6.41209577e+43,
     6.09536897e+43,   5.88843655e+43,   5.57185749e+43,
     5.32108259e+43,   5.17606832e+43,   4.96592321e+43,
     4.73151259e+43,   4.56036916e+43,   4.38530698e+43,
     4.20726628e+43,   4.00866718e+43,   3.88150366e+43,
     3.71535229e+43,   3.57272838e+43,   3.45939378e+43,
     3.30369541e+43,   3.17687407e+43,   3.02691343e+43,
     2.96483139e+43,   2.83791903e+43,   2.74157417e+43,
     2.67300641e+43,   2.54097271e+43,   2.46036760e+43,
     2.37137371e+43,   2.30144182e+43,   2.21819642e+43,
     2.16271852e+43,   2.07491352e+43,   2.00909281e+43,
     1.91866874e+43,   1.87931682e+43,   1.79887092e+43,
     1.75388050e+43,   1.68267406e+43,   1.64437172e+43,
     1.58489319e+43,   1.52054753e+43,   1.46554784e+43,
     1.43218790e+43,   1.40604752e+43,   1.36144468e+43,
     1.32434154e+43,   1.28528666e+43,   1.24738351e+43,
     1.21618600e+43,   1.17760597e+43,   1.14551294e+43,
     1.11429453e+43,   1.08143395e+43,   1.06169556e+43,
     1.02565193e+43,   1.00230524e+43,   9.74989638e+42,
     9.41889597e+42,   9.09913273e+42,   8.91250938e+42,
     8.60993752e+42,   8.45278845e+42,   8.24138115e+42,
     7.99834255e+42,   7.78036551e+42,   7.63835784e+42,
     7.39605275e+42,   7.17794291e+42,   7.07945784e+42,
     6.90239804e+42,   6.79203633e+42,   6.59173895e+42,
     6.51628394e+42,   6.29506183e+42,   6.19441075e+42,
     6.09536897e+42,   5.95662144e+42,   5.82103218e+42,
     5.66239289e+42,   5.58470195e+42,   5.45757861e+42,
     5.33334895e+42,   5.19995997e+42,   5.12861384e+42,
     5.03500609e+42,   4.93173804e+42,   4.74241985e+42,
     4.68813382e+42,   4.62381021e+42,   4.44631267e+42,
     4.41570447e+42,   4.29536427e+42,   4.20726628e+42,
     4.11149721e+42,   4.01790811e+42,   3.97191549e+42,
     3.87257645e+42,   3.80189396e+42,   3.72391706e+42,
     3.67282300e+42,   3.57272838e+42,   3.51560441e+42,
     3.43557948e+42,   3.41192912e+42,   3.35737614e+42,
     3.31131121e+42,   3.23593657e+42,   3.16956746e+42,
     3.13328572e+42,   3.07609681e+42,   3.01995172e+42,
     2.97166603e+42,   2.89734359e+42,   2.87078058e+42,
     2.83139200e+42,   2.79898132e+42,   2.71019163e+42,
     2.67300641e+42,   2.62421854e+42,   2.58226019e+42,
     2.52929800e+42,   2.47742206e+42,   2.43220401e+42,
     2.40990543e+42,   2.35504928e+42,   2.31739465e+42,
     2.28034207e+42,   2.23357222e+42,   2.20800473e+42,
     2.15774441e+42,   2.11836114e+42,   2.07491352e+42,
     2.04173794e+42,   2.00447203e+42,   1.97242274e+42,
     1.94088588e+42,   1.90546072e+42,   1.89670592e+42,
     1.87068214e+42,   1.84077200e+42,   1.80717413e+42,
     1.78237877e+42,   1.74582215e+42,   1.72583789e+42,
     1.70215851e+42,   1.67109061e+42,   1.65958691e+42,
     1.62181010e+42,   1.58489319e+42,   1.58124804e+42,
     1.55596563e+42,   1.52405275e+42,   1.49623566e+42,
     1.48251809e+42,   1.44877185e+42,   1.43548943e+42,
     1.40928880e+42,   1.39315680e+42,   1.36144468e+42,
     1.33659552e+42,   1.31825674e+42,   1.30316678e+42,
     1.26765187e+42,   1.25602996e+42,   1.23594743e+42,
     1.21338885e+42,   1.18576875e+42,   1.17489755e+42,
     1.14815362e+42,   1.14024979e+42,   1.11429453e+42,
     1.09395637e+42,   1.07151931e+42,   1.05925373e+42,
     1.03992017e+42,   1.01859139e+42,   1.00925289e+42,
     1.00000000e+42,   9.81747943e+41,   9.68277856e+41,
     9.61612278e+41,   9.50604794e+41,   9.31107875e+41,
     9.14113241e+41,   8.95364766e+41,   8.83079900e+41,
     8.70963590e+41,   8.57037845e+41,   8.47227414e+41,
     8.43334758e+41,   8.22242650e+41,   8.09095899e+41,
     7.99834255e+41,   7.87045790e+41,   7.72680585e+41,
     7.74461798e+41,   7.53355564e+41,   7.36207097e+41,
     7.26105957e+41,   7.09577768e+41,   7.09577768e+41,
     7.01455298e+41,   6.96626514e+41,   6.71428853e+41,
     6.60693448e+41,   6.51628394e+41,   6.41209577e+41,
     6.23734835e+41,   6.23734835e+41,   6.12350392e+41,
     5.99791076e+41,   5.86138165e+41,   5.83445104e+41,
     5.75439937e+41,   5.64936975e+41,   5.61047976e+41,
     5.50807696e+41,   5.35796658e+41,   5.32108259e+41,
     5.22396189e+41,   5.12861384e+41,   5.10505000e+41,
     5.05824662e+41,   4.93173804e+41,   4.84172368e+41,
     4.70977326e+41,   4.72063041e+41,   4.67735141e+41,
     4.61317575e+41,   4.57088190e+41,   4.52897580e+41,
     4.47713304e+41,   4.39541615e+41,   4.31519077e+41,
     4.27562886e+41,   4.19758984e+41,   4.13999675e+41,
     4.11149721e+41,   4.03645393e+41,   3.95366620e+41,
     3.93550075e+41,   3.89045145e+41,   3.88150366e+41,
     3.78442585e+41,   3.70680722e+41,   3.68977599e+41,
     3.65594792e+41,   3.58096437e+41,   3.53183170e+41,
     3.53183170e+41,   3.41192912e+41,   3.37287309e+41,
     3.36511569e+41,   3.27340695e+41,   3.25087297e+41,
     3.16227766e+41,   3.14774831e+41,   3.14050869e+41,
     3.11171634e+41,   3.00607630e+41,   2.96483139e+41,
     2.93089325e+41,   2.87078058e+41,   2.78612117e+41,
     2.79898132e+41,   2.77332010e+41,   2.71019163e+41,
     2.70395836e+41,   2.66072506e+41,   2.57632116e+41,
     2.56448404e+41,   2.52929800e+41,   2.47742206e+41,
     2.44906324e+41,   2.39331576e+41,   2.38781128e+41,
     2.33883724e+41,   2.32273680e+41,   2.28034207e+41,
     2.25423921e+41,   2.18776162e+41,   2.17770977e+41,
     2.14783047e+41,   2.11348904e+41,   2.08449088e+41,
     2.05589060e+41,   2.04173794e+41,   1.99526231e+41,
     1.96336028e+41,   1.97696964e+41,   1.94088588e+41,
     1.91866874e+41,   1.89670592e+41,   1.90546072e+41,
     1.87931682e+41,   1.84926862e+41,   1.83231442e+41,
     1.83231442e+41,   1.77827941e+41,   1.73780083e+41,
     1.72981636e+41,   1.71001532e+41,   1.67880402e+41,
     1.66341265e+41,   1.64058977e+41,   1.61435856e+41,
     1.62554876e+41,   1.58854675e+41,   1.55596563e+41,
     1.58124804e+41,   1.53815464e+41,   1.51705037e+41,
     1.48593564e+41,   1.47231250e+41,   1.47910839e+41,
     1.47910839e+41,   1.41579378e+41,   1.39958732e+41,
     1.36144468e+41,   1.35518941e+41,   1.34896288e+41,
     1.32739446e+41,   1.30918192e+41,   1.29419584e+41,
     1.27938130e+41,   1.26182753e+41,   1.25892541e+41,
     1.23026877e+41,   1.21898960e+41,   1.22743923e+41,
     1.18304156e+41,   1.17489755e+41,   1.18576875e+41,
     1.16412603e+41,   1.16144861e+41,   1.11173173e+41,
     1.10153931e+41,   1.08893009e+41,   1.06659612e+41,
     1.06169556e+41,   1.04472022e+41,   1.04231743e+41,
     1.02329299e+41,   1.01157945e+41,   9.95405417e+40,
     9.63829024e+40,   9.54992586e+40,   9.44060876e+40,
     9.41889597e+40,   9.33254301e+40,   9.22571427e+40,
     9.12010839e+40,   8.99497582e+40,   8.72971368e+40,
     8.70963590e+40,   8.59013522e+40,   8.45278845e+40,
     8.41395142e+40,   8.29850768e+40,   8.22242650e+40,
     8.18464788e+40,   8.01678063e+40,   7.81627805e+40,
     7.76247117e+40,   7.69130440e+40,   7.49894209e+40,
     7.46448758e+40,   7.26105957e+40,   7.19448978e+40,
     7.16143410e+40,   6.99841996e+40,   6.96626514e+40,
     6.80769359e+40,   6.63743070e+40,   6.71428853e+40,
     6.68343918e+40,   6.62216504e+40,   6.79203633e+40,
     6.48634434e+40,   6.45654229e+40,   6.36795521e+40,
     6.33869711e+40,   6.29506183e+40,   6.25172693e+40,
     6.18016400e+40,   6.13762005e+40,   6.26613865e+40,
     6.01173737e+40,   5.94292159e+40,   5.88843655e+40,
     5.74116462e+40,   5.72796031e+40,   5.67544605e+40,
     5.76766463e+40,   5.70164272e+40]

# age in units of Myr
dage = 0.2
agemax = 40.0
age = np.arange(0, agemax + dage, dage)
fPsi = interp1d(age, Psi)
#fPsi = interp1d(age, Psi, fillvalue="extrapolate")

dage = 0.1
agemax = 50.0
#age = np.arange(0.01, agemax, dage)
age = np.arange(0.0, agemax, dage)
fXi = interp1d(age, Xi)

def calc_LFUV(mass, age):
    """Given mass [Msun] and age [Myr], returns FUV luminosity of star cluster"""
    
    return mass*fPsi(age)

def calc_Qi(mass, age):
    """Given mass [Msun] and age [Myr], returns FUV luminosity of star cluster"""
    
    return mass*fXi(age)

if __name__ == '__main__':
    print calc_Qi(100.0, 0.0)
    print calc_LFUV(1.0, 0.0)
